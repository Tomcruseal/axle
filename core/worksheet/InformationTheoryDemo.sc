object InformationTheoryDemo {

  println("Information Theory Demo")              //> Information Theory Demo

  import collection._
  import axle.stats._

  // Entropy

  entropy(coin())                                 //> res0: axle.quanta.Information.Q = 1.0 b

  H(die(6))                                       //> res1: axle.quanta.Information.Q = 2.584962500721156 b

  H(coin())                                       //> res2: axle.quanta.Information.Q = 1.0 b

  import axle.visualize._
  import axle.quanta.Information._
  import Plottable._

  val hm = new immutable.TreeMap[Double, Q]() ++ (0 to 100).map(i => (i / 100.0, entropy(coin(i / 100.0)))).toMap
                                                  //> hm  : scala.collection.immutable.TreeMap[Double,axle.quanta.Information.Q] =
                                                  //|  Map(0.0 -> 0.0 b, 0.01 -> 0.08079313589591118 b, 0.02 -> 0.1414405425418206
                                                  //| 7 b, 0.03 -> 0.19439185783157623 b, 0.04 -> 0.24229218908241482 b, 0.05 -> 0
                                                  //| .28639695711595625 b, 0.06 -> 0.32744491915447627 b, 0.07 -> 0.3659236509002
                                                  //| 2333 b, 0.08 -> 0.4021791902022729 b, 0.09 -> 0.4364698170641029 b, 0.1 -> 0
                                                  //| .4689955935892812 b, 0.11 -> 0.499915958164528 b, 0.12 -> 0.5293608652873644
                                                  //|  b, 0.13 -> 0.5574381850279891 b, 0.14 -> 0.584238811642856 b, 0.15 -> 0.609
                                                  //| 8403047164004 b, 0.16 -> 0.6343095546405662 b, 0.17 -> 0.6577047787442195 b,
                                                  //|  0.18 -> 0.6800770457282798 b, 0.19 -> 0.7014714598838974 b, 0.2 -> 0.721928
                                                  //| 0948873623 b, 0.21 -> 0.7414827399312737 b, 0.22 -> 0.7601675029619657 b, 0.
                                                  //| 23 -> 0.7780113035465377 b, 0.24 -> 0.7950402793845223 b, 0.25 -> 0.81127812
                                                  //| 44591328 b, 0.26 -> 0.8267463724926178 b, 0.27 -> 0.8414646362081757 b, 0.28
                                                  //|  -> 0.8554508105601307 b, 0.29 -> 0.8687212463394045 b, 0.3 -> 0.88129089923
                                                  //| 06927 b, 0.31 -> 0.8931734583778568 b, 0.32 -> 0.9043814577244941 b, 0.33 ->
                                                  //|  0.9149263727797275 b, 0.34 -> 0.9248187049730301 b, 0.35 -> 0.9340680553754
                                                  //| 91 b, 0.36 -> 0.9426831892554922 b, 0.37 -> 0.9506720926870659 b, 0.38 -> 0.
                                                  //| 9580420222262995 b, 0.39 -> 0.9647995485050872 b, 0.4 -> 0.9709505944546686 
                                                  //| b, 0.41 -> 0.976500468757824 b, 0.42 -> 0.9814538950336535 b, 0.43 -> 0.9858
                                                  //| 150371789198 b, 0.44 -> 0.9895875212220557 b, 0.45 -> 0.9927744539878084 b, 
                                                  //| 0.46 -> 0.9953784388202258 b, 0.47 -> 0.9974015885677396 b, 0.48 -> 0.998845
                                                  //| 5359952018 b, 0.49 -> 0.9997114417528099 b, 0.5 -> 1.0 b, 0.51 -> 0.99971144
                                                  //| 17528099 b, 0.52 -> 0.9988455359952018 b, 0.53 -> 0.9974015885677396 b, 0.54
                                                  //|  -> 0.9953784388202258 b, 0.55 -> 0.9927744539878084 b, 0.56 -> 0.9895875212
                                                  //| 220557 b, 0.57 -> 0.9858150371789198 b, 0.58 -> 0.9814538950336537 b, 0.59 -
                                                  //| > 0.9765004687578241 b, 0.6 -> 0.9709505944546686 b, 0.61 -> 0.9647995485050
                                                  //| 872 b, 0.62 -> 0.9580420222262995 b, 0.63 -> 0.9506720926870659 b, 0.64 -> 0
                                                  //| .9426831892554922 b, 0.65 -> 0.934068055375491 b, 0.66 -> 0.92481870497303 b
                                                  //| , 0.67 -> 0.9149263727797275 b, 0.68 -> 0.904381457724494 b, 0.69 -> 0.89317
                                                  //| 34583778568 b, 0.7 -> 0.8812908992306927 b, 0.71 -> 0.8687212463394046 b, 0.
                                                  //| 72 -> 0.8554508105601307 b, 0.73 -> 0.8414646362081757 b, 0.74 -> 0.82674637
                                                  //| 24926178 b, 0.75 -> 0.8112781244591328 b, 0.76 -> 0.7950402793845223 b, 0.77
                                                  //|  -> 0.7780113035465376 b, 0.78 -> 0.7601675029619657 b, 0.79 -> 0.7414827399
                                                  //| 312736 b, 0.8 -> 0.7219280948873623 b, 0.81 -> 0.7014714598838974 b, 0.82 ->
                                                  //|  0.68007704572828 b, 0.83 -> 0.6577047787442195 b, 0.84 -> 0.634309554640566
                                                  //| 2 b, 0.85 -> 0.6098403047164005 b, 0.86 -> 0.584238811642856 b, 0.87 -> 0.55
                                                  //| 74381850279891 b, 0.88 -> 0.5293608652873644 b, 0.89 -> 0.499915958164528 b,
                                                  //|  0.9 -> 0.46899559358928117 b, 0.91 -> 0.4364698170641028 b, 0.92 -> 0.40217
                                                  //| 91902022728 b, 0.93 -> 0.36592365090022305 b, 0.94 -> 0.32744491915447643 b,
                                                  //|  0.95 -> 0.2863969571159563 b, 0.96 -> 0.24229218908241493 b, 0.97 -> 0.1943
                                                  //| 918578315763 b, 0.98 -> 0.14144054254182076 b, 0.99 -> 0.08079313589591124 b
                                                  //| , 1.0 -> 0.0 b)

  val plot = Plot(List(("h", hm)),
    connect = true, drawKey = false,
    xAxis = 0.0 *: bit, xAxisLabel = Some("p(x='HEAD)"),
    yAxis = 0.0, yAxisLabel = Some("H"),
    title = Some("Entropy"))(DoublePlottable, Information.UnitPlottable(bit))
                                                  //> plot  : axle.visualize.Plot[Double,Nothing,axle.quanta.Information.Q,Nothing
                                                  //| ] = Plot(List((h,Map(0.0 -> 0.0 b, 0.01 -> 0.08079313589591118 b, 0.02 -> 0.
                                                  //| 14144054254182067 b, 0.03 -> 0.19439185783157623 b, 0.04 -> 0.24229218908241
                                                  //| 482 b, 0.05 -> 0.28639695711595625 b, 0.06 -> 0.32744491915447627 b, 0.07 ->
                                                  //|  0.36592365090022333 b, 0.08 -> 0.4021791902022729 b, 0.09 -> 0.436469817064
                                                  //| 1029 b, 0.1 -> 0.4689955935892812 b, 0.11 -> 0.499915958164528 b, 0.12 -> 0.
                                                  //| 5293608652873644 b, 0.13 -> 0.5574381850279891 b, 0.14 -> 0.584238811642856 
                                                  //| b, 0.15 -> 0.6098403047164004 b, 0.16 -> 0.6343095546405662 b, 0.17 -> 0.657
                                                  //| 7047787442195 b, 0.18 -> 0.6800770457282798 b, 0.19 -> 0.7014714598838974 b,
                                                  //|  0.2 -> 0.7219280948873623 b, 0.21 -> 0.7414827399312737 b, 0.22 -> 0.760167
                                                  //| 5029619657 b, 0.23 -> 0.7780113035465377 b, 0.24 -> 0.7950402793845223 b, 0.
                                                  //| 25 -> 0.8112781244591328 b, 0.26 -> 0.8267463724926178 b, 0.27 -> 0.84146463
                                                  //| 62081757 b, 0.28 -> 0.8554508105601307 b, 0.29 -> 0.8687212463394045 b, 0.3 
                                                  //| -> 0.8812908992306927 b, 0.31 -> 0.8931734583778568 b, 0.32 -> 0.90438145772
                                                  //| 44941 b, 0.33 -> 0.9149263727797275 b, 0.34 -> 0.9248187049730301 b, 0.35 ->
                                                  //|  0.934068055375491 b, 0.36 -> 0.9426831892554922 b, 0.37 -> 0.95067209268706
                                                  //| 59 b, 0.38 -> 0.9580420222262995 b, 0.39 -> 0.9647995485050872 b, 0.4 -> 0.9
                                                  //| 709505944546686 b, 0.41 -> 0.976500468757824 b, 0.42 -> 0.9814538950336535 b
                                                  //| , 0.43 -> 0.9858150371789198 b, 0.44 -> 0.9895875212220557 b, 0.45 -> 0.9927
                                                  //| 744539878084 b, 0.46 -> 0.9953784388202258 b, 0.47 -> 0.9974015885677396 b, 
                                                  //| 0.48 -> 0.9988455359952018 b, 0.49 -> 0.9997114417528099 b, 0.5 -> 1.0 b, 0.
                                                  //| 51 -> 0.9997114417528099 b, 0.52 -> 0.9988455359952018 b, 0.53 -> 0.99740158
                                                  //| 85677396 b, 0.54 -> 0.9953784388202258 b, 0.55 -> 0.9927744539878084 b, 0.56
                                                  //|  -> 0.9895875212220557 b, 0.57 -> 0.9858150371789198 b, 0.58 -> 0.9814538950
                                                  //| 336537 b, 0.59 -> 0.9765004687578241 b, 0.6 -> 0.9709505944546686 b, 0.61 ->
                                                  //|  0.9647995485050872 b, 0.62 -> 0.9580420222262995 b, 0.63 -> 0.9506720926870
                                                  //| 659 b, 0.64 -> 0.9426831892554922 b, 0.65 -> 0.934068055375491 b, 0.66 -> 0.
                                                  //| 92481870497303 b, 0.67 -> 0.9149263727797275 b, 0.68 -> 0.904381457724494 b,
                                                  //|  0.69 -> 0.8931734583778568 b, 0.7 -> 0.8812908992306927 b, 0.71 -> 0.868721
                                                  //| 2463394046 b, 0.72 -> 0.8554508105601307 b, 0.73 -> 0.8414646362081757 b, 0.
                                                  //| 74 -> 0.8267463724926178 b, 0.75 -> 0.8112781244591328 b, 0.76 -> 0.79504027
                                                  //| 93845223 b, 0.77 -> 0.7780113035465376 b, 0.78 -> 0.7601675029619657 b, 0.79
                                                  //|  -> 0.7414827399312736 b, 0.8 -> 0.7219280948873623 b, 0.81 -> 0.70147145988
                                                  //| 38974 b, 0.82 -> 0.68007704572828 b, 0.83 -> 0.6577047787442195 b, 0.84 -> 0
                                                  //| .6343095546405662 b, 0.85 -> 0.6098403047164005 b, 0.86 -> 0.584238811642856
                                                  //|  b, 0.87 -> 0.5574381850279891 b, 0.88 -> 0.5293608652873644 b, 0.89 -> 0.49
                                                  //| 9915958164528 b, 0.9 -> 0.46899559358928117 b, 0.91 -> 0.4364698170641028 b,
                                                  //|  0.92 -> 0.4021791902022728 b, 0.93 -> 0.36592365090022305 b, 0.94 -> 0.3274
                                                  //| 4491915447643 b, 0.95 -> 0.2863969571159563 b, 0.96 -> 0.24229218908241493 b
                                                  //| , 0.97 -> 0.1943918578315763 b, 0.98 -> 0.14144054254182076 b, 0.99 -> 0.080
                                                  //| 79313589591124 b, 1.0 -> 0.0 b))),true,false,700,600,50,4,Some(Entropy),0.0 
                                                  //| b,Some(p(x='HEAD)),0.0,Some(H))

  // show(plot)
  // png(plot, "entropy.png")

}